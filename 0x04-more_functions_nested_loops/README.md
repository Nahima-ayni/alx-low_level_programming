more fumctions and more nested loops
